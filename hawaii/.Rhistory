mod_stoc <- astsa::LagReg(input = Birds_sm, output = Birds_cm, L = 10, M = 10)
mod_stoc <- astsa::LagReg(input = Birds_sm, output = Birds_cm, L = 3, M = 10)
mod_stoc <- astsa::LagReg(input = Birds_sm, output = Birds_cm, L = 20, M = 10)
mod_stoc <- astsa::LagReg(input = Birds_sm, output = Birds_cm, L = 15, M = 10)
mod_ctos <- astsa::LagReg(input = Birds_cm, output = Birds_sm, L = 15, M = 10, inverse = TRUE,  threshold = 0.01)
mod_ctos <- astsa::LagReg(input = Birds_cm, output = Birds_sm, L = 3, M = 10, inverse = TRUE,  threshold = 0.01)
mod_ctos <- astsa::LagReg(input = Birds_cm, output = Birds_sm, L = 3, M = 10, inverse = TRUE)
mod_stoc <- astsa::LagReg(input = Birds_sm, output = Birds_cm, L = 15, M = 10)
acf(Birds_cm, lag = 10, main = "Coot.Maui")
astsa::ccf2(Birds_sm, Birds_cm, max.lag = 10, main = "Stilt vs. Coot in Maui", ylab = "CCF")
acf(Birds_cm, lag = 10, main = "Coot.Maui")
acf(Birds_cm, lag = 10, main = "Coot.Maui")
birds <- ts.intersect(cm = Birds_cm, cm1 = stats::lag(Birds_cm, -1),  sm = Birds_sm,  sm1 = stats::lag(Birds_sm, -1))
( u <- lm(birds[,1] ~ birds[,2:4], na.action = NULL) )
summary(u)
birds
birds <- ts.intersect(cm = Birds_cm, cm1 = stats::lag(Birds_cm, -1),  sm = Birds_sm,  sm1 = stats::lag(Birds_sm, -1))
( u <- lm(birds[,1] ~ birds[,2:4], na.action = NULL) )
summary(u)
birds <- ts.intersect(cm = Birds_cm, cm1 = stats::lag(Birds_cm, -1),  sm = Birds_sm,  sm1 = stats::lag(Birds_sm, -2))
( u <- lm(birds[,1] ~ birds[,2:4], na.action = NULL) )
summary(u)
birds <- ts.intersect(cm = Birds_cm, cm1 = stats::lag(Birds_cm, -1),  sm = Birds_sm,  sm1 = stats::lag(Birds_sm, 1))
( u <- lm(birds[,1] ~ birds[,2:4], na.action = NULL) )
summary(u)
birds <- ts.intersect(cm = Birds_cm, cm1 = stats::lag(Birds_cm, -1),  sm = Birds_sm)
( u <- lm(birds[,1] ~ birds[,2:3], na.action = NULL) )
summary(u)
birds
birds <- ts.intersect(cm = Birds_cm, sm = Birds_sm, sm1 = stats::lag(Birds_sm, -1))
( u <- lm(birds[,1] ~ birds[,2:3], na.action = NULL) )
summary(u)
birds <- ts.intersect(cm = Birds_cm, sm = Birds_sm, sm1 = stats::lag(Birds_sm, -2))
( u <- lm(birds[,1] ~ birds[,2:3], na.action = NULL) )
car::scatterplot(Birds_cm ~ Birds_sm, smooth = T)
car::scatterplot(Birds_cm ~ Birds_sm)
car::scatterplot(Birds_cm ~ Birds_sm, smooth = FALSE)
astsa::lag2.plot(Birds_sm, Birds_cm, max.lag = 12)
sm.d <- resid(lm(Birds_sm ~ time(Birds_sm), na.action = NULL))
acf2(sm.d)
acf(Birds_sm, lag = 10, main = "Stilt.Maui")
lm(Birds_sm ~ time(Birds_sm)
summary(lm(Birds_sm ~ time(Birds_sm)))
summary(lm(Birds_sm ~ time(Birds_sm)))
sm.d <- resid(lm(Birds_sm ~ time(Birds_sm), na.action = NULL))
acf2(sm.d)
sarima(birds[,1], 1, 0, 0, xreg = birds[,2:3])
birds <- ts.intersect(cm = Birds_cm, sm = Birds_sm, sm1 = stats::lag(Birds_sm, 1))
( u <- lm(birds[,1] ~ birds[,2:3], na.action = NULL) )
summary(u)
birds <- ts.intersect(cm = Birds_cm, sm = Birds_sm, cm1 = stats::lag(Birds_cm, -1))
( u <- lm(birds[,1] ~ birds[,2:3], na.action = NULL) )
summary(u)
birds <- ts.intersect(cm = Birds_cm, sm = sm.d, cm1 = stats::lag(Birds_cm, -1))
( u <- lm(birds[,1] ~ birds[,2:3], na.action = NULL) )
acf2(resid(u))
summary(u)
( u <- lm(birds[,1] ~ birds[,2], na.action = NULL) )
summary(u)
acf2(resid(u))
birds <- ts.intersect(cm = Birds_cm, sm = sm.d, cm1 = stats::lag(Birds_cm, -1))
arx <- sarima(birds[,1], 1, 0, 0, xreg = birds[,2:3])
arx <- sarima(birds[,1], 1, 0, 0, xreg = birds[,2])
birds <- ts.intersect(cm = Birds_cm, sm = Birds_sm)
( u <- lm(birds[,1] ~ birds[,2:3], na.action = NULL) )
summary(u)
arx <- sarima(birds[,1], 1, 0, 0, xreg = birds[,2])
birds <- ts.intersect(cm = Birds_cm, sm = Birds_sm)
arx <- sarima(birds[,1], 1, 0, 0, xreg = birds[,2])
birds <- ts.intersect(cm = Birds_cm, sm = Birds_sm)
Birds_sm
birds <- ts.intersect(cm = Birds_cm, sm = Birds_sm)
Birds_cm
birds <- ts.intersect(cm = Birds_cm, sm = Birds_sm)
summary(lm(Birds_sm ~ time(Birds_sm)))
# Detrended Stilt.Maui
sm.d <- resid(lm(Birds_sm ~ time(Birds_sm), na.action = NULL))
acf2(sm.d)
birds <- ts.intersect(cm = Birds_cm, sm = sm.d, cm1 = stats::lag(Birds_cm, -1))
Birds_sm
Birds_cm
birds <- ts.intersect(cm = Birds_cm, sm = Birds_sm)
Birds_sm <- Hawaii$Stilt.Maui
Birds_cm <- Hawaii$Coot.Maui
Birds_so <- Hawaii$Stilt.Oahu
Birds_co <- Hawaii$Coot.Oahu
summary(lm(Birds_sm ~ time(Birds_sm)))
# Detrended Stilt.Maui
sm.d <- resid(lm(Birds_sm ~ time(Birds_sm), na.action = NULL))
acf2(sm.d)
birds <- ts.intersect(cm = Birds_cm, sm = Birds_sm)
birds <- ts.intersect(cm = Birds_cm, sm = Birds_sm, cm1 = stats::lag(Birds_cm, -1))
birds <- ts.intersect(cm = Birds_cm, sm = sm.d, cm1 = stats::lag(Birds_cm, -1))
( u <- lm(birds[,1] ~ birds[,2:3], na.action = NULL) )
summary(u)
acf2(resid(u))
arx <- sarima(birds[,1], 1, 0, 0, xreg = birds[,2])
birds <- ts.intersect(cm = Birds_cm, sm = sm.d, cm1 = stats::lag(Birds_cm, -1))
# only take 2nd variable for explanatory variable  (not lag)
( u <- lm(birds[,1] ~ birds[,2], na.action = NULL) )
summary(u)
acf2(resid(u))
# ----------
# final model
arx <- sarima(birds[,1], 1, 0, 0, xreg = birds[,2])
birds <- ts.intersect(cm = Birds_cm, sm = sm.d, cm1 = stats::lag(Birds_cm, -1))
( u <- lm(birds[,1] ~ birds[,2], na.action = NULL) )
arx <- sarima(birds[,1], 1, 0, 0, xreg = birds[,2])
Birds_sm
sm.d
birds <- ts.intersect(cm = Birds_cm, sm = sm.d, cm1 = stats::lag(Birds_cm, -1))
arx <- sarima(birds[,1], 1, 0, 0, xreg = birds[,2])
arx
arx <- sarima(birds[,1], 1, 0, 0, xreg = birds[,2:3])
arx
arx <- sarima(birds[,1], 1, 0, 0, xreg = birds[,2:3])
pred <- rec + resid(arx$fit)
birds <- ts.intersect(cm = Birds_cm, sm = sm.d, cm1 = stats::lag(Birds_cm, -1))
arx <- sarima(birds[,1], 1, 0, 0, xreg = birds[,2])
arx
pred <- rec + resid(arx$fit)
ts.plot(pred, Birds_cm, col = c('skyblue', "black"), lwd = c(7,2))
pred <- Birds_cm + resid(arx$fit)
ts.plot(pred, Birds_cm, col = c('skyblue', "black"), lwd = c(7,2))
par(mfrow = c(1,1))
ts.plot(pred, Birds_cm, col = c('skyblue', "black"), lwd = c(7,2))
summary(u)
E2 <- residuals(BM2$lme, type = "normalized")
EAll <- vector(length = length(Birds))
EAll[] <- NA
I1 <- !is.na(Birds)
EAll[I1] <- E2
xyplot(EAll ~ Time | ID, col = 1, ylab = "Residuals", type = "o")
EAAll
RAll
EAll
formula <- ~ sqrt(Moorhen.Kauai) + sqrt(Stilt.Oahu) + sqrt(Stilt.Maui) + sqrt(Coot.Oahu) + log(Coot.Maui) + log(Rainfall) + Year
scatterplotMatrix(formula, data = Hawaii,
smooth = FALSE,
id = list(n = 3), ellipse = TRUE, col = gray(0.3), pch = 20)
head(Hawaii)
rain <- Hawaii$Rainfall
birds <- ts.intersect(cm = Birds_cm, sm = Birds_sm, rain = Rain, cm1 = stats::lag(Birds_cm, -1))
( u <- lm(birds[,1] ~ birds[,2:3], na.action = NULL) )
summary(u)
( u <- lm(birds[,1] ~ birds[,2:4], na.action = NULL) )
summary(u)
birds <- ts.intersect(cm = Birds_cm, sm = Birds_sm, rain = Rain, cm1 = stats::lag(Birds_cm, -1))
# not take into account cm1
( u <- lm(birds[,1] ~ birds[,2:3], na.action = NULL) )
summary(u)
car::residualPlots(u)
plot(BM2$gam, scale = FALSE, shade = TRUE)
plot(BM2$gam, scale = FALSE, shade = TRUE)
graphics.off()
par(mfrow = c(2,2))
plot(BM2$gam, scale = FALSE, shade = TRUE)
s(as.numeric(Time), by = ID), weights = varIdent(form = ~1 | ID), correlation = corAR1(form = ~ Time | ID))
BM2 <- gamm(Birds ~ Rain + ID +
s(as.numeric(Time), by = ID), weights = varIdent(form = ~1 | ID), correlation = corAR1(form = ~ Time | ID))
plot(BM2$gam, scale = FALSE, shade = TRUE)
plot(BM1$gam, scale = FALSE, shade = TRUE)
( u <- gam(Birds_cm ~ s(as.numetric(Time)) ~ Birds_sm + Rain) )
Birds_cm
Time
year <- Hawaii$Year
year
# not take into account cm1
( u <- gam(Birds_cm ~ s(as.numetric(year)) ~ Birds_sm + Rain) )
( u <- gam(Birds_cm ~ s(as.numetric(year)) + Birds_sm + Rain) )
( u <- gam(Birds_cm ~ s(as.numeric(year)) + Birds_sm + Rain) )
Rain
rain <- Hawaii$Rainfall
rain
( u <- gam(Birds_cm ~ s(as.numeric(year)) + Birds_sm + rain) )
summary(u)
( u <- gam(Birds_cm ~ s(as.numeric(year)) + Birds_sm) )
summary(u)
plot(u$gam, scale = FALSE, shade = TRUE)
plot(u, scale = FALSE, shade = TRUE)
predict(u)
plot(predict(u), type = "l", lwd = 1, col = "black")
plot(Birds_cm, type = "l", ltye = 2, lwd = 1, col = "black")
lines(predict(u), type = "l", lwd = 2, col = "blue")
par(mfrow = c(1,1))
plot(Birds_cm, type = "l", ltye = 2, lwd = 1, col = "black")
lines(predict(u), type = "l", lwd = 2, col = "blue")
graphics.off()
par(mfrow = c(1,1))
plot(Birds_cm, type = "l", lty = 2, lwd = 1, col = "black")
lines(predict(u), type = "l", lwd = 2, col = "blue")
graphics.off()
par(mfrow = c(1,1))
plot(Birds_cm, type = "l", lty = 2, lwd = 1, col = "black")
lines(predict(u), type = "l", lwd = 2, col = "blue")
graphics.off()
par(mfrow = c(1,1))
plot(u, scale = FALSE, shade = TRUE)
( u <- gam(Birds_cm ~ s(as.numeric(year)) + Birds_sm + s(rain)) )
summary(u)
graphics.off()
par(mfrow = c(1,1))
plot(u, scale = FALSE, shade = TRUE)
summary(u)
# ------------------------------------------------------------------------------
# plot smoothers
# ------------------------------------------------------------------------------
graphics.off()
par(mfrow = c(1,1))
plot(u, scale = FALSE, shade = TRUE)
graphics.off()
par(mfrow = c(1,2))
plot(u, scale = FALSE, shade = TRUE)
( u <- gam(Birds_cm ~ s(as.numeric(year)) + Birds_sm) )
summary(u)
( u <- gam(Birds_cm ~ s(as.numeric(year)) + s(Birds_sm)) )
summary(u)
graphics.off()
par(mfrow = c(1,2))
plot(u, scale = FALSE, shade = TRUE)
graphics.off()
par(mfrow = c(1,1))
plot(Birds_cm, type = "l", lty = 2, lwd = 1, col = "black")
lines(predict(u), type = "l", lwd = 2, col = "blue")
( u <- gam(Birds_cm ~ s(as.numeric(year)) + s(sm.d)) )
summary(u)
( u <- gam(Birds_cm ~ s(as.numeric(year)) + sm.d) )
summary(u)
graphics.off()
par(mfrow = c(1,2))
plot(u, scale = FALSE, shade = TRUE)
graphics.off()
par(mfrow = c(1,1))
plot(Birds_cm, type = "l", lty = 2, lwd = 1, col = "black")
lines(predict(u), type = "l", lwd = 2, col = "blue")
plot(resid(u))
plot(resid(u), type = "o")
resid(u)
Birds_cm
( u <- gam(Birds_cm ~ s(as.numeric(year)) + s(Birds_sm)) )
graphics.off()
par(mfrow = c(1,2))
plot(u, scale = FALSE, shade = TRUE)
plot(resid(u), type = "o")
graphics.off()
par(mfrow = c(1,1))
plot(Birds_cm, type = "l", lty = 2, lwd = 1, col = "black")
lines(predict(u), type = "l", lwd = 2, col = "blue")
lag(birds_cm,-1)
lag(Birds_cm, -1)
( u <- gam(Birds_cm ~ s(as.numeric(year)) + lag(Birds_cm, -1)) )
( u <- gam(Birds_cm ~ s(as.numeric(year)) + stats::lag(Birds_cm, -1)) )
summary(u)
( u <- gam(Birds_cm ~ s(as.numeric(year)) + s(Birds_sm) + stats::lag(Birds_cm, -1)) )
summary(u)
( u <- gam(Birds_cm ~ s(as.numeric(year)) + stats::lag(Birds_cm, -1)) )
summary(u)
( u <- gam(Birds_cm ~ s(as.numeric(year)) + s(Birds_sm)) )
summary(u)
graphics.off()
par(mfrow = c(1,2))
plot(u, scale = FALSE, shade = TRUE)
plot(resid(u), type = "o")
par(mfrow = c(1,1))
plot(resid(u), type = "o")
( u <- gamm(Birds_cm ~ s(as.numeric(year)) + s(Birds_sm), correlation = corAR1(form = ~ year)) )
summary(u)
summary(u$gam)
summary(u$lme)
help(gamm)
( u <- gamm(Birds_cm ~ s(Birds_sm), correlation = corAR1(form = ~ year)) )
summary(u$gam)
summary(u$lme)
graphics.off()
par(mfrow = c(1,2))
plot(u, scale = FALSE, shade = TRUE)
plot(u$gam, scale = FALSE, shade = TRUE)
par(mfrow = c(1,1))
plot(resid(u), type = "o")
graphics.off()
par(mfrow = c(1,1))
plot(Birds_cm, type = "l", lty = 2, lwd = 1, col = "black")
lines(predict(u), type = "l", lwd = 2, col = "blue")
( u <- gamm(Birds_cm ~ s(as.numeric(year)) + s(Birds_sm), correlation = corAR1(form = ~ year)) )
summary(u$gam)
anova(u$gam)
summary(u$lme)
( u <- gamm(Birds_cm ~ s(as.numeric(year)) + s(Birds_sm), correlation = corAR1(form = ~ 1)) )
summary(u$gam)
anova(u$gam)
# ----------
summary(u$lme)
anova(u$gam)
summary(u$gam)
( u <- gamm(Birds_cm ~ s(as.numeric(year)) + s(Birds_sm), correlation = corAR1(form = ~ year)) )
# ----------
summary(u$gam)
anova(u$gam)
summary(u$gam)
summary(u$lme)
graphics.off()
par(mfrow = c(2,2))
plot(u$gam, scale = FALSE, shade = TRUE)
par(mfrow = c(1,2))
plot(u$gam, scale = FALSE, shade = TRUE)
E2 <- residuals(u$lme, type = "normalized")
EAll <- vector(length = length(Birds_cm))
EAll[] <- NA
I1 <- !is.na(Birds)
EAll[I1] <- E2
xyplot(EAll ~ Time | ID, col = 1, ylab = "Residuals", type = "o")
E2
EAll <- vector(length = length(Birds_cm))
EAll[] <- NA
I1 <- !is.na(Birds_cm)
EAll[I1] <- E2
E2
xyplot(EAll ~ year | ID, col = 1, ylab = "Residuals", type = "o")
xyplot(EAll ~ year, col = 1, ylab = "Residuals", type = "o")
acf(EAll, na.action = na.pass)
par(mfrow = c(1,1))
acf(EAll, na.action = na.pass)
xyplot(EAll ~ year, col = 1, ylab = "Residuals", type = "o")
Birds <- c(Hawaii$Stilt.Oahu, Hawaii$Stilt.Maui, Hawaii$Coot.Oahu, Hawaii$Coot.Maui)
Time <- rep(Hawaii$Year, 4)
Rain <- rep(Hawaii$Rainfall, 4)
ID <- factor(rep(c("Stilt.Oahu", "Stilt.Maui", "Coot.Oahu", "Coot.Maui"), each = length(Hawaii$Year)))
# ----------
xyplot(Birds ~ Time | ID, col = 1, type = "o")
E22 <- residuals(u$lme, type = "normalized")
EAll2 <- vector(length = length(Birds_cm))
EAll2[] <- NA
I12 <- !is.na(Birds_cm)
EAll2[I12] <- E22
xyplot(EAll2 ~ year, col = 1, ylab = "Residuals", type = "o")
BM2 <- gamm(Birds ~ Rain + ID +
s(as.numeric(Time), by = ID), weights = varIdent(form = ~1 | ID), correlation = corAR1(form = ~ Time | ID))
E2 <- residuals(BM2$lme, type = "normalized")
EAll <- vector(length = length(Birds))
EAll[] <- NA
I1 <- !is.na(Birds)
EAll[I1] <- E2
xyplot(EAll ~ Time | ID, col = 1, ylab = "Residuals", type = "o")
xyplot(EAll2 ~ year, col = 1, ylab = "Residuals", type = "o")
xyplot(EAll ~ Time | ID, col = 1, ylab = "Residuals", type = "o")
length(EAll)
192/3
192/4
xyplot(EAll[49:96] ~ Time[48:96], col = 1, ylab = "Residuals", type = "o")
EAll[49:96]
48*3
xyplot(EAll[97:144] ~ Time[97:144], col = 1, ylab = "Residuals", type = "o")
ID
idx <- which(ID == "Coot.Maui")
xyplot(EAll[idx] ~ Time[idx], col = 1, ylab = "Residuals", type = "o")
xyplot(EAll2 ~ year, col = 1, ylab = "Residuals", type = "o")
xyplot(EAll2 ~ year, col = 1, ylab = "Residuals", type = "o", main = "residuals predicted by Stilt.Maui")
xyplot(EAll[idx] ~ Time[idx], col = 1, ylab = "Residuals", type = "o", main = "All model")
xyplot(EAll2 ~ year, col = 1, ylab = "Residuals", type = "o", main = "residuals of Coot.Maui predicted by Stilt.Maui")
xyplot(EAll[idx] ~ Time[idx], col = 1, ylab = "Residuals", type = "o", main = "residual of Coot.Maui by All model")
xyplot(EAll[idx] ~ Time[idx], col = 1, ylab = "Residuals", type = "o", main = "residual of Coot.Maui by All model", ylim = c(-3, 3))
xyplot(EAll2 ~ year, col = 1, ylab = "Residuals", type = "o", main = "residuals of Coot.Maui predicted by Stilt.Maui", ylim = c(-3, 3))
xyplot(EAll2 ~ year, col = 1, ylab = "Residuals", type = "o", main = "residuals of Coot.Maui predicted by Stilt.Maui", ylim = c(-3, 3))
abline(h = 0)
xyplot(EAll2 ~ year, col = 1, ylab = "Residuals", type = "o", main = "residuals of Coot.Maui predicted by Stilt.Maui", ylim = c(-3, 3))
xyplot(EAll[idx] ~ Time[idx], col = 1, ylab = "Residuals", type = "o", main = "residual of Coot.Maui by All model", ylim = c(-3, 3))
plot(EAll2 ~ year, col = 1, ylab = "Residuals", type = "o", main = "residuals of Coot.Maui predicted by Stilt.Maui", ylim = c(-3, 3))
plot(EAll2 ~ year, col = 1, ylab = "Residuals", type = "o", main = "residuals of Coot.Maui predicted by Stilt.Maui", ylim = c(-3, 3))
abline(h = 0, lty = 2, col = "gray")
lines(EAll[idx] ~ Time[idx], col = "blue", ylab = "Residuals", type = "o", main = "residual of Coot.Maui by All model", ylim = c(-3, 3))
( u <- gamm(Birds_cm ~ s(as.numeric(year)) + s(Birds_sm) + s(rain), correlation = corAR1(form = ~ year)) )
# ----------
summary(u$gam)
anova(u$gam)
summary(u$lme)
graphics.off()
par(mfrow = c(1,2))
plot(u$gam, scale = FALSE, shade = TRUE)
par(mfrow = c(2,2))
plot(u$gam, scale = FALSE, shade = TRUE)
graphics.off()
par(mfrow = c(2,2))
plot(u$gam, scale = FALSE, shade = TRUE)
E22 <- residuals(u$lme, type = "normalized")
EAll2 <- vector(length = length(Birds_cm))
EAll2[] <- NA
I12 <- !is.na(Birds_cm)
EAll2[I12] <- E22
plot(EAll2 ~ year, col = 1, ylab = "Residuals", type = "o", main = "residuals of Coot.Maui predicted by Stilt.Maui", ylim = c(-3, 3))
abline(h = 0, lty = 2, col = "gray")
# ----------
# for comparison
BM2 <- gamm(Birds ~ Rain + ID +
s(as.numeric(Time), by = ID), weights = varIdent(form = ~1 | ID), correlation = corAR1(form = ~ Time | ID))
E2 <- residuals(BM2$lme, type = "normalized")
EAll <- vector(length = length(Birds))
EAll[] <- NA
I1 <- !is.na(Birds)
EAll[I1] <- E2
idx <- which(ID == "Coot.Maui")
lines(EAll[idx] ~ Time[idx], col = "blue", ylab = "Residuals", type = "o", main = "residual of Coot.Maui by All model", ylim = c(-3, 3))
graphics.off()
par(mfrow = c(1,1))
plot(EAll2 ~ year, col = 1, ylab = "Residuals", type = "o", main = "residuals of Coot.Maui predicted by Stilt.Maui", ylim = c(-3, 3))
abline(h = 0, lty = 2, col = "gray")
# ----------
# for comparison
BM2 <- gamm(Birds ~ Rain + ID +
s(as.numeric(Time), by = ID), weights = varIdent(form = ~1 | ID), correlation = corAR1(form = ~ Time | ID))
E2 <- residuals(BM2$lme, type = "normalized")
EAll <- vector(length = length(Birds))
EAll[] <- NA
I1 <- !is.na(Birds)
EAll[I1] <- E2
idx <- which(ID == "Coot.Maui")
lines(EAll[idx] ~ Time[idx], col = "blue", ylab = "Residuals", type = "o", main = "residual of Coot.Maui by All model", ylim = c(-3, 3))
( u <- gamm(Birds_cm ~ s(as.numeric(year)) + s(Birds_sm) + s(rain), correlation = corAR1(form = ~ year)) )
summary(u$gam)
anova(u$gam)
summary(u$lme)
graphics.off()
par(mfrow = c(2,2))
plot(u$gam, scale = FALSE, shade = TRUE)
( u <- gamm(Birds_cm ~ pbc(as.numeric(year)) + s(Birds_sm) + s(rain), correlation = corAR1(form = ~ year)) )
( u <- gamm(Birds_cm ~ pb(as.numeric(year)) + s(Birds_sm) + s(rain), correlation = corAR1(form = ~ year)) )
( u <- gamm(Birds_cm ~ bs(as.numeric(year)) + s(Birds_sm) + s(rain), correlation = corAR1(form = ~ year)) )
( u <- gamm(Birds_cm ~ te(as.numeric(year), rain) + s(Birds_sm) + s(rain), correlation = corAR1(form = ~ year)) )
( u <- gamm(Birds_cm ~ ti(as.numeric(year), rain) + s(Birds_sm) + s(rain), correlation = corAR1(form = ~ year)) )
summary(u$gam)
( u <- gamm(Birds_cm ~ ti(as.numeric(year), rain) + s(Birds_sm), correlation = corAR1(form = ~ year)) )
anova(u$gam)
summary(u$gam)
summary(u$lme)
graphics.off()
par(mfrow = c(2,2))
plot(u$gam, scale = FALSE, shade = TRUE)
E22 <- residuals(u$lme, type = "normalized")
EAll2 <- vector(length = length(Birds_cm))
EAll2[] <- NA
I12 <- !is.na(Birds_cm)
EAll2[I12] <- E22
graphics.off()
par(mfrow = c(1,1))
plot(EAll2 ~ year, col = 1, ylab = "Residuals", type = "o", main = "residuals of Coot.Maui predicted by Stilt.Maui", ylim = c(-3, 3))
abline(h = 0, lty = 2, col = "gray")
lines(EAll[idx] ~ Time[idx], col = "blue", ylab = "Residuals", type = "o", main = "residual of Coot.Maui by All model", ylim = c(-3, 3))
( u <- gamm(Birds_cm ~ ti(as.numeric(year), rain) + s(Birds_sm)) )
summary(u$gam)
anova(u$gam)
# ----------
summary(u$lme)
graphics.off()
par(mfrow = c(2,2))
plot(u$gam, scale = FALSE, shade = TRUE)
E22 <- residuals(u$lme, type = "normalized")
EAll2 <- vector(length = length(Birds_cm))
EAll2[] <- NA
I12 <- !is.na(Birds_cm)
EAll2[I12] <- E22
graphics.off()
par(mfrow = c(1,1))
plot(EAll2 ~ year, col = 1, ylab = "Residuals", type = "o", main = "residuals of Coot.Maui predicted by Stilt.Maui", ylim = c(-3, 3))
abline(h = 0, lty = 2, col = "gray")
lines(EAll[idx] ~ Time[idx], col = "blue", ylab = "Residuals", type = "o", main = "residual of Coot.Maui by All model", ylim = c(-3, 3))
( u <- gamm(Birds_cm ~ ti(as.numeric(year), rain) + s(Birds_sm), correlation = corGaus(form = ~ year)) )
summary(u$gam)
anova(u$gam)
# ----------
summary(u$lme)
( u <- gamm(Birds_cm ~ ti(as.numeric(year), rain) + s(Birds_sm), correlation = corGaus(form = ~ year, nugget = TRUE)) )
summary(u$lme)
graphics.off()
par(mfrow = c(2,2))
plot(u$gam, scale = FALSE, shade = TRUE)
E22 <- residuals(u$lme, type = "normalized")
EAll2 <- vector(length = length(Birds_cm))
EAll2[] <- NA
I12 <- !is.na(Birds_cm)
EAll2[I12] <- E22
graphics.off()
par(mfrow = c(1,1))
plot(EAll2 ~ year, col = 1, ylab = "Residuals", type = "o", main = "residuals of Coot.Maui predicted by Stilt.Maui", ylim = c(-3, 3))
abline(h = 0, lty = 2, col = "gray")
lines(EAll[idx] ~ Time[idx], col = "blue", ylab = "Residuals", type = "o", main = "residual of Coot.Maui by All model", ylim = c(-3, 3))
( u <- gamm(Birds_cm ~ ti(as.numeric(year), rain) + s(Birds_sm), correlation = corAR1(form = ~ year)) )
( u <- gamm(Birds_cm ~ s(as.numeric(year)) + ti(Birds_sm, rain), correlation = corAR1(form = ~ year)) )
summary(u$gam)
anova(u$gam)
# ----------
summary(u$lme)
summary(u$gam)
anova(u$gam)
summary(u$gam)
( u <- gamm(Birds_cm ~ s(as.numeric(year)) + s(Birds_sm, rain), correlation = corAR1(form = ~ year)) )
summary(u$gam)
anova(u$gam)
# ----------
summary(u$lme)
graphics.off()
par(mfrow = c(2,2))
plot(u$gam, scale = FALSE, shade = TRUE)
E22 <- residuals(u$lme, type = "normalized")
EAll2 <- vector(length = length(Birds_cm))
EAll2[] <- NA
I12 <- !is.na(Birds_cm)
EAll2[I12] <- E22
graphics.off()
par(mfrow = c(1,1))
plot(EAll2 ~ year, col = 1, ylab = "Residuals", type = "o", main = "residuals of Coot.Maui predicted by Stilt.Maui", ylim = c(-3, 3))
abline(h = 0, lty = 2, col = "gray")
lines(EAll[idx] ~ Time[idx], col = "blue", ylab = "Residuals", type = "o", main = "residual of Coot.Maui by All model", ylim = c(-3, 3))
anova(u$gam)
